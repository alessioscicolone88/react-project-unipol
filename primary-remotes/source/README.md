# This is the repository of the Primary Remotes

# Drakkar Information

team: tpd
application: web
component: primary-remotes

# Gain access to RepoNexus from the repositories

- After you have gain access to RepoNexus, create the '.npmrc' file next to package.json containing these information:

```
  email=<email>
  registry=https://reponexus.servizi.gr-u.it/repository/npm-all/
  always-auth=true
  _auth=<credBase64>
  strict-ssl=false
  sass_binary_site=https://<username>:<password>@reponexus.servizi.gr-u.it/repository/node-raw-proxy
  webdriver_update_site=https://<username>:<password>@reponexus.servizi.gr-u.it/repository/e2e-webdrivers/
  chromedriver_cdnurl=https://<username>:<password>@reponexus.servizi.gr-u.it/repository/e2e-webdrivers/
  chromedriver_version=2.35`
```

Where:
<email>: Unipol Email, log in "https://reponexus.servizi.gr-u.it/", then you click on the user icon on the top right corner, in the modal you will see the right email
<username>: Username UnipolSai in lowercase letters
<password>: Password of the UnipolSai credentials
<credBase64>: base64 String generated by running `btoa('username:password');` on the browser. The username must be inserted in lowercase letters.

# Installation:

Prerequisites:

- it required a version of node ~16.14.2
- it required the "unisalute VPN" active
- Create .env file in the root of the repository contains
  ```
    DEPLOY_ENV_NAME="local"
  ```

To install dependencies in all projects, from the root of the project run the following commands from terminal:

- run `npm install` (required unisalute VPN active)

- After the first installation run `npm run configure-husky` to initialize husky for pre-commit with esLint and Prettier, discard the changes in "<repo>/.husky/pre-commit"

# Process to start the environments in local with dev settings:

[1] go to "common-libs/source" directory and run the following commands from terminal:
-- `npm run build-dev`

[2] go to "angular-libs/source" directory and run the following commands from terminal:
-- `npm run build-dev`

[3] go to "core-remotes/source" and "widget-remotes/source" and "primary-remotes/source" directories and for all of them run the following commands from terminal:
-- `npm run link-tpd-web-libs` (required unisalute VPN active)

[4] go to "next/source" directory and run the following commands from terminal:
-- `npm run link-tpd-web-libs` (required unisalute VPN active)

[5] go to "mfe-unipol-tpdweb/cms-proxy" directory and run the following commands from terminal:
-- `npm run link-tpd-web-libs` (required unisalute VPN active)

[6] go to "mfe-unipol-tpdweb/cms-proxy" directory and run the following commands from terminal:
-- `npm run start-dev`

[7] go to "core-remotes/source" and "widget-remotes/source" and "primary-remotes/source" directories and for all of them run the following commands from terminal:
-- `npm run start-dev` (wait until all remotes are compiled successfully)

[8] go to "next/source" directory and run the following commands from terminal:
-- `npm run start-dev`

# Process to start the environments in local with prod settings:

[1] go to "common-libs/source" directory and run the following commands from terminal:
-- `npm run build-local-prod`

[2] go to "angular-libs/source" directory and run the following commands from terminal:
-- `npm run build-local-prod`

[3] go to "core-remotes/source" and "widget-remotes/source" and "primary-remotes/source" directories and for all of them run the following commands from terminal:
-- `npm run link-tpd-web-libs` (required unisalute VPN active)

[4] go to "next/source" directory and run the following commands from terminal:
-- `npm run link-tpd-web-libs` (required unisalute VPN active)

[5] go to "mfe-unipol-tpdweb/cms-proxy" directory and run the following commands from terminal:
-- `npm run link-tpd-web-libs` (required unisalute VPN active)

[6] go to "mfe-unipol-tpdweb/cms-proxy" directory and run the following commands from terminal:
-- `npm run start-local-prod`

[7] go to "core-remotes/source" and "widget-remotes/source" and "primary-remotes/source" directories and for all of them run the following commands from terminal:
-- `npm run build-local-prod && npm run start-local-prod`

[8] go to "next/source" directory and run the following commands from terminal:
-- `npm run build-local-prod && npm run start-local-prod`
